<!DOCTYPE html>
<html>
<head>
    <title>Smol Wiki</title>
    <script>
async function loadWiki() {
    const CACHE_KEY = 'smol-wiki-index';
    const CACHE_TIME = 5 * 60 * 1000; // 5 minutes
    
    // Check cache first
    const cached = localStorage.getItem(CACHE_KEY);
    if (cached) {
        const { data, timestamp } = JSON.parse(cached);
        if (Date.now() - timestamp < CACHE_TIME) {
            document.getElementById('wiki-list').innerHTML = data;
            return;
        }
    }
    
    try {
        const response = await fetch(
            'https://api.github.com/repos/miguelsantosdesign/smol-wiki/contents/wiki?ref=main'
        );
        const files = await response.json();
        let html = '';
        
        for (const file of files.filter(f => f.name.endsWith('.html'))) {
            const title = file.name
                .replace('.html', '')
                .replace(/-/g, ' ')
                .replace(/\b\w/g, l => l.toUpperCase());
            
            html += `
                <li>
                    <a href="wiki/${file.name}">
                        ${title}
                    </a>
                </li>
            `;
        }
        
        document.getElementById('wiki-list').innerHTML = html;
        
        // Save to cache
        localStorage.setItem(CACHE_KEY, JSON.stringify({
            data: html,
            timestamp: Date.now()
        }));
        
    } catch (error) {
        document.getElementById('wiki-list').innerHTML = 
            `<li>Error loading wiki. Using cached version if available.</li>`;
    }
}
loadWiki();
</script>
</head>
<body>
    <h1>Smol Wiki</h1>
    <ul id="wiki-list"></ul>
</body>
</html>
